# 01 基于轻量化卷积神经网络的人脸表情识别方法

## 难点

+ `数据分布问题`。大规模的表情数据中包含的人脸来自于不同年龄、种族、性别和文化，这就导致了人脸的外观差别较大。如何克服这种类内差异是人脸表情识别必须要解决的问题。
+ `头部姿态的影响`。不同场景中的人脸存在不同程度的偏转，非实验室环境中几乎不可能捕捉到正面的人脸。如何合理地将人脸正面化且不影响后续表情识别也是一个需要克服的难点。
+ `周围环境干扰`。自然环境中的人脸不可避免的存在光照变化。当光照较强时人脸表面的反光较严重，具体会体现在像素值的局部增高，进而影响识别精度。除了光照变化，人们在生活中会佩戴各种饰品，例如眼镜和帽子，该情况下的人脸会存在部分遮挡，这意味着有部分的人脸信息无法被用来识别表情。因此，周围环境干扰是表情识别的一个主要难点。
+ `深度学习模型精度和实时性的平衡问题`。深度大的神经网络具有强大的学习能力，但是`无法应用到现实场景`中；浅层的神经网络计算速度快，但是缺乏足够的表征能力。在深度模型中引入`轻量化技术`还是设计新的深度学习模型也是当前的一个难点。

# 卷积神经网络轻量化技术

> 深度学习神经网络`轻量化`是指对在`保证任务模型精度`情况下对模型进行精简的方法。经过`模型压缩`后的网络参数量会更少，计算量通常也会减少，这使得计算开销与存储开销大大降低，为模型部署在受限的硬件条件下提供了可能。

+ `剪枝优化`

剪枝优化通过`自动算法或者人工分析`去除模型层间的穴余连接。其目的是在尽量保持原网络性能的同时，尽量降低计算成本和减少参数数量，`删除在深度神经网络中那些无效或未能得到高效率利用的特征，籍此加速训练过程和网络传播速度，同时也能减少参数空间中的穴余，可以有效提升模型的泛化能力`。剪枝操作本质上是一种在网络整体结构不变的前提下找出网络层每层中需要多少连接及如何连接才能获得最佳性能的结构探索操作。网络剪枝从剪枝粒度可以分为：

​		单个权重剪枝

​		核内权重剪枝

​		卷积核剪枝

​		通道剪枝

​		隐层剪枝

+ `权值参数共享`

权值参数共享的主要思想就是让网络中`多个参数共享同一值`，以提升减少参数量，提高单位容量的利用率。其最初于2010年初的早期网络LeNet中被提出，在之后的CNN研究中被作为核心思想而广泛使用。

+ `量化`

量化操作通过`降低权重所需要的比特数以减少原始网络的大小`，主要包括`低精度`和`重编码`两类方法。在常规CNN中，网络模型权重参数值的数据类型一般默认为float32。

`低精度`方法即使用相比默认设定位数更少的浮点数（如float16)或整型数（int8)对相应的网络结构进行初始化训练和使用；

`重编码`则对已完成训练的网络权重值进行重新编码，通过预设的映射规则，采用更少的位数对原网络数值进行转化表达，实现模型的轻量化。

+ 知识蒸馏

### 轻量化网络结构设计

轻量化网络结构设计选择`应用新的网络模块重新设计网络结构`，利用`深度可分离卷积`、`分组卷积`、`通道混洗`等方法，在尽量不影响精度的前提下减少参数量，压缩模型。

在`分类任务`中，`量化`几乎可以做到`不损失精度`，但是目标检测或者图像分割等复杂任务中，由于对参数变化非常敏感，量化通常会对模型精度造成巨大损失。

### 深度可分离卷积

Sifre等人于`2014`年提出`深度可分离卷积`的概念，使用该策略改进AlexNet,可保持分类精度并减少结构参数量和计算量[链接](https://arxiv.org/pdf/1403.1687v1.pdf)。随后深度可分离卷积作为轻量化网络的核心，先后在Xception、SqueezeNet、SqueezeNext、MobileNet、MobileNetV2、ShuffleNet和ShuffleNetV2等主流的轻量化网络研究中得到关注和应用。

与常规卷积不同，深度可分离卷积运算将常规卷积运算分解为`深度卷积`和`逐点卷积`两步，其中深度卷积负责进行`空间相关性的计算`，对特征进行总结归纳，逐点卷积进行`通道相关性的计算`，主要负责调整出特征通道数。