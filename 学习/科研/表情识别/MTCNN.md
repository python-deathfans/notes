> `人脸检测和对齐`是人脸识别和表情分析等许多人脸应用的基础。然而，人脸视觉上的巨大变化，如`遮挡、大姿态变化和极端光照`，对这些任务在现实世界中的应用提出了巨大的挑战。Viola和Jones提出的`级联人脸检测器`利用类`Haar特征和AdaBoost`训练级联分类器，取得了良好的性能和实时性。然而，大量的文献表明，即使使用更高级的特征和分类器，这种检测器在人脸视觉变化较大的实际应用中可能会严重退化。
>
> `人脸对齐`也引起了广泛的研究兴趣。这方面的研究工作大致可分为两类，`基于回归`的方法和`模板拟合`方法。
>
> 然而，以往的`人脸检测`和`对齐`方法大多忽略了这两个任务之间的内在联系
>
> 我们提出了一个新的框架来整合这两个任务使用统一的`级联CNN`多任务学习。建议的CNNs包括`三个阶段`。在第一阶段，它通过一个`浅层的CNN`快速`生成候选窗口`。然后通过大量的窗口对其进行优化。最后，它使用一个更强大的CNN来再次细化结果并输出five facial landmarks positions所有的标记位置。

## 步骤

 ![](https://pic.downk.cc/item/5f15256114195aa5942026ef.png)![](https://pic.downk.cc/item/5f13ec2114195aa594c59b28.png)
![](https://pic.downk.cc/item/5f13ec2114195aa594c59b2a.png)

+ ![](https://pic.downk.cc/item/5f13fc9b14195aa594ca2fe9.png)
+ `构建图像金字塔`
  + 首先将图像进行不同尺度的变换，构建图像金字塔，以适应不同大小的人脸的进行检测，构建方式是通过不同的缩放系数**factor**对图片进行缩放，每次缩小为原来的factor大小(factor=0.709)
+ 送入PNET网络
  + Pnet的全称为Proposal Network,其基本的构造是一个`全连接网络`。对上一步构建完成的图像金字塔，通过一个FCN进行`初步特征提取`与`边框标定`。
  + 获得`候选人脸窗口`及其`边界盒回归向量`
  + 非最大抑制（`NMS`）来合并高度重叠的候选对象
+ 送入RNET网络
  + Rnet全称为`Refine Network`,其基本的构造是一个卷积神经网络，相对于第一层的P-Net来说，增加了一个`全连接层`，因此对于输入数据的筛选会更加严格。在图片经过P-Net后，会留下许多预测窗口，我们将所有的预测窗口送入R-Net,这个网络会滤除大量效果比较差的候选框。
+ 送入ONET网络
  + 这一阶段与第二阶段相似，但在这一阶段，我们的目标是确定有更多监督的面部区域。特别是，该网络将输出`五个面部标志的位置`。